library(flex)
library(flex)
library(flex)
source('~/.active-rstudio-document')
library(flex)
library(flex)
library(flex)
library(flex)
source('~/.active-rstudio-document')
library(flex)
library(flex)
library(flex)
remove.packages("flex")
library(flex)
library(flex)
remove.packages("flex")
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
library(flex)
library(flex)
library(flex)
source('~/.active-rstudio-document')
library(flex)
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
.04926466*750
.0369411*1000
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
.04937867*750
(.05717-0.020136)*1000
library(flex)
source('~/.active-rstudio-document')
library(flex)
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
View(c)
View(read.table(mutfiles[1]))
View(read.table(mutfiles[2]))
a = read.table(popfiles[length(popfiles)], header = T)
b = read.table(lblfiles[length(lblfiles)], header = T)
par(mfrow=c(1,3))
for(i in 2:ncol(a)-1){
plot(a[,1], a[,i], main = colnames(a)[i], ylab = "Population size", xlab = "time")
plot(b[,1], b[,i], main = colnames(b)[i],ylim = c(0,1), xlab = "time",
ylab = "Fraction Labelled", col = "red")
mutfiles = list.files(inDir, pattern=paste("^out.*", colnames(a)[i], ".mut$", sep = ""), full.names = F)
c = read.table(mutfiles[length(mutfiles)], header = F, fill = TRUE, col.names = paste0("V", seq_len(max(count.fields(mutfiles[length(mutfiles)])))))
c[is.na(c)] = 0
matplot(c[,2:ncol(c)], main = colnames(a)[i])
}
infofiles = list.files(inDir, pattern="^out.*.info$", full.names=F)
info = read.table(infofiles[length(infofiles)], header = T)
evtfiles = list.files(inDir, pattern = "^out.*.events$", full.names = F)
evt = read.table(evtfiles[length(evtfiles)], header = T)
#View(evt)
options(scipen = 999)
print(apply(evt, 2, mean), )
par(mfrow=c(1,3))
for(i in 2:ncol(a)){
plot(a[,1], a[,i], main = colnames(a)[i], ylab = "Population size", xlab = "time")
plot(b[,1], b[,i], main = colnames(b)[i],ylim = c(0,1), xlab = "time",
ylab = "Fraction Labelled", col = "red")
mutfiles = list.files(inDir, pattern=paste("^out.*", colnames(a)[i], ".mut$", sep = ""), full.names = F)
c = read.table(mutfiles[length(mutfiles)], header = F, fill = TRUE, col.names = paste0("V", seq_len(max(count.fields(mutfiles[length(mutfiles)])))))
c[is.na(c)] = 0
matplot(c[,2:ncol(c)], main = colnames(a)[i])
}
infofiles = list.files(inDir, pattern="^out.*.info$", full.names=F)
info = read.table(infofiles[length(infofiles)], header = T)
evtfiles = list.files(inDir, pattern = "^out.*.events$", full.names = F)
evt = read.table(evtfiles[length(evtfiles)], header = T)
#View(evt)
options(scipen = 999)
print(apply(evt, 2, mean), )
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
.3*.01
source('~/.active-rstudio-document')
.0001*.6
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
0
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
library(flex)
library(flex)
library(flex)
library(flex)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
library(flex)
library(flex)
library(flex)
library(flex)
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('~/.active-rstudio-document')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
View(evt)
source('C:/DFCI/Jeremy/flex/example3.R')
View(evt)
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
View(evt)
View(a)
View(evt)
for(cp in names(a)){
print(cp)
}
for(cp in names(a)[2:length(names(a))]){
print(cp)
}
for(cp in names(a)[2:length(names(a))]){
print(grepl( cp , names(evt) ))
}
evt2[,grepl( cp , names(evt) )]
evt2 = evt
evt2[,grepl( cp , names(evt) )]
popsize = a$cp
popzie
popsize
evt2 = evt
for(i in 2:length(names(a))){
popsize = a$i
cp = names(a)[i]
print(grepl( cp , names(evt) ))
evt2[,grepl( cp , names(evt) )]
}
cp = names(a)[i]
cp
popsize
evt2 = evt
for(row in 2:nrow(evt)){
for(i in 2:length(names(a))){
popsize = a[row-1,i]
cp = names(a)[i]
print(grepl( cp , names(evt) ))
evt2[row,grepl( cp , names(evt) )] = evt2[row,grepl( cp , names(evt) )] / popsize
}
}
View(evt2)
View(evt2)
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
View(evt)
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
library(flex)
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
inDir = paste(getwd(), "/example/", sep = "")
setwd(inDir)
popfiles = list.files(inDir, pattern="^out.*.pop$", full.names=F)
lblfiles = list.files(inDir, pattern="^out.*.label$", full.names=F)
sdifiles = list.files(inDir, pattern="^out.*.sdi$", full.names=F)
a = read.table(popfiles[length(popfiles)], header = T)
b = read.table(lblfiles[length(lblfiles)], header = T)
d = read.table(sdifiles[length(sdifiles)], header = T)
par(mfrow=c(2,2))
for(i in 2:ncol(a)){
plot(a[,1], a[,i], main = colnames(a)[i], ylab = "Population size", xlab = "time")
plot(b[,1], b[,i], main = colnames(b)[i],ylim = c(0,1), xlab = "time",
ylab = "Fraction Labelled", col = "red")
mutfiles = list.files(inDir, pattern=paste("^out.*", colnames(a)[i], ".mut$", sep = ""), full.names = F)
c = read.table(mutfiles[length(mutfiles)], header = F, fill = TRUE, col.names = paste0("V", seq_len(max(count.fields(mutfiles[length(mutfiles)])))))
c[is.na(c)] = 0
matplot(c[,2:ncol(c)], main = colnames(a)[i])
plot(d[,1], d[,i], main = colnames(a)[i], ylab = "SDI", xlab = "time")
}
infofiles = list.files(inDir, pattern="^out.*.info$", full.names=F)
info = read.table(infofiles[length(infofiles)], header = T)
evtfiles = list.files(inDir, pattern = "^out.*.events$", full.names = F)
evt = read.table(evtfiles[length(evtfiles)], header = T)
#View(evt)
options(scipen = 999)
evt2 = evt
for(row in 2:nrow(evt)){
for(i in 2:length(names(a))){
popsize = a[row-1,i]
cp = names(a)[i]
#print(grepl( cp , names(evt) ))
evt2[row,grepl( cp , names(evt) )] = evt2[row,grepl( cp , names(evt) )] / popsize
}
}
print(apply(evt2[2:nrow(evt2),], 2, mean), )
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/example3.R')
install.packages("devtools")
devtools::install_git("https://github.com/olliemcdonald/siapopr")
install.packages("dplyr")
library(flex)
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
library(flex)
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/example3.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
230/60
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenize()
library(flex)
library(flex)
Rcpp::sourceCpp('C:/DFCI/Jeremy/flex/flex/src/newController.cpp')
library(flex)
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
library(flex)
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
source('C:/DFCI/Jeremy/flex/test_cellpop1.R')
library(flex)
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
library(flex)
library(ggplot2)
setwd("C:/DFCI/Jeremy/flex/flex/example/")
directory = "C:/DFCI/Jeremy/flex/flex/example/"
files = grep("slurm", list.files(directory),value=TRUE)
files = grep("*.sdi", list.files(directory),value=TRUE)
prefixes = tools::file_path_sans_ext(files)
source('C:/DFCI/old/DFCI/HSC/read_raw.R')
View(full_data)
p = prefixes[1]
info_file = read.table(paste(p, ".info", sep = ""))
p
setwd("C:/DFCI/Jeremy/flex/flex/example/")
info_file = read.table(paste(p, ".info", sep = ""))
View(info_file)
sdi_file = read.table(paste(p, ".sdi", sep = ""))
View(sdi)
View(sdi_file)
info_file = read.table(paste(p, ".info", sep = ""), header = T)
sdi_file = read.table(paste(p, ".sdi", sep = ""), header = T)
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
library(ggplot2)
setwd("C:/DFCI/Jeremy/flex/flex/example/")
directory = "C:/DFCI/Jeremy/flex/flex/example/"
files = grep("*.sdi", list.files(directory),value=TRUE)
prefixes = tools::file_path_sans_ext(files)
full_data = data.frame()
for (p in prefixes){
info_file = read.table(paste(p, ".info", sep = ""), header = T)
sdi_file = read.table(paste(p, ".sdi", sep = ""), header = T)
sdi_file$group = paste(info_file$alpha_LT, info_file$beta_LT, info_file$gamma_LT, sep = "-")
# if(nrow(a) == 4003 & !paste(a[1,1], a[2,1], a[3,1], sep = "-") %in% full_data$group){
#   colnames(a) = "sdi"
#   a$alpha = a[1,1]
#   a$beta = a[2,1]
#   a$gamma = a[3,1]
#   a = a[seq(4,4003),]
#   a$step = 1:4000
#   a$group = paste(a$alpha[1], a$beta[1], a$gamma[1], sep = "-")
#   full_data = rbind(full_data, a)
# }
full_data = rbind(full_data, sdi_file)
}
View(full_data)
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
source('C:/DFCI/Jeremy/flex/read_raw.R')
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
source('C:/DFCI/Jeremy/flex/read_raw.R')
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
source('C:/DFCI/Jeremy/flex/read_raw.R')
betas = seq(0.002, 0.018, 0.002)
betas
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
source('C:/DFCI/Jeremy/flex/read_raw.R')
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
source('C:/DFCI/Jeremy/flex/read_raw.R')
source('C:/DFCI/Jeremy/flex/hsc_lt_sdi.R')
source('C:/DFCI/Jeremy/flex/read_raw.R')
source('C:/DFCI/Jeremy/flex/read_raw.R')
library(flex)
source('C:/DFCI/Jeremy/flex/HSC_CellPop_addTri.R')
source('C:/DFCI/Jeremy/flex/HSC_CellPop_addTri.R')
source('C:/DFCI/Jeremy/flex/label_LT.R')
